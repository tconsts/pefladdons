// ==UserScript==
// @name           pefladaptation
// @namespace      pefl
// @description    adaptaton map
// @include        http://*pefl.*/?adaptation
// @version        1.0
// ==/UserScript==


var nationplayers = {
11:564,
12:685,
13:511,
1:360,
2:428,
3:0,
6:0,
61:2508,
5:62,
4:23,
7:6,
8:1878,
9:216,
10:2,
0:19,
14:0,
16:1,
17:8,
15:6,
20:2,
18:722,
19:1439,
21:44,
22:2,
30:771,
24:569,
25:557,
26:6,
27:2687,
28:1,
29:0,
31:53,
32:13,
23:0,
203:0,
87:678,
204:523,
205:4,
71:47,
83:35,
82:0,
72:50,
75:188,
213:2,
79:8,
80:75,
81:45,
74:1618,
84:1003,
85:30,
86:2,
77:3,
76:725,
73:407,
78:0,
53:1037,
54:0,
55:0,
56:7,
153:100,
59:566,
211:38,
212:42,
94:443,
89:1,
90:2,
99:0,
92:50,
91:386,
93:766,
88:542,
172:1639,
95:2019,
208:0,
37:45,
100:319,
38:2,
34:0,
35:226,
36:120,
152:230,
101:34,
50:164,
103:31,
42:696,
138:29,
44:1135,
215:10,
45:76,
47:335,
96:437,
49:11,
102:0,
132:36,
104:3,
105:439,
107:4,
108:32,
106:31,
109:8,
111:449,
110:36,
112:37,
121:3,
120:9,
114:15,
113:0,
66:335,
115:31,
116:1,
118:108,
117:0,
119:32,
126:542,
122:789,
127:28,
123:214,
124:0,
125:1,
128:0,
130:33,
131:0,
136:8,
137:412,
135:1,
134:53,
133:1,
139:927,
195:283,
140:3,
46:0,
141:3,
142:4,
143:34,
144:0,
145:364,
147:257,
149:944,
150:931,
151:28,
155:2233,
156:16,
154:411,
60:24,
157:0,
158:23,
159:2,
160:311,
179:5,
129:500,
163:0,
162:188,
176:2,
174:3,
175:0,
209:1382,
165:1,
182:32,
166:529,
167:646,
168:5,
169:8,
177:0,
178:29,
196:485,
164:42,
184:26,
186:3,
216:0,
43:1,
185:3,
194:1,
188:53,
189:0,
190:34,
191:290,
193:22,
192:1249,
199:28,
202:355,
200:998,
201:694,
207:381,
67:59,
68:1,
148:10,
69:680,
70:1681,
48:968,
39:13,
40:7,
214:398,
51:560,
41:452,
181:512,
180:884,
161:1140,
173:2,
58:676,
62:3,
63:1,
64:470,
65:9,
170:616,
171:858,
97:40,
98:1393,
}
var nationteamnum = {
214:12,
209:36,
207:18,
204:22,
202:16,
201:20,
200:36,
196:28,
195:12,
192:38,
191:12,
181:28,
180:32,
172:66,
171:28,
170:26,
167:24,
166:24,
161:42,
160:12,
155:110,
154:18,
152:12,
150:36,
149:36,
147:12,
145:12,
139:32,
137:12,
129:16,
126:16,
123:10,
122:34,
111:20,
105:20,
100:20,
98:52,
96:14,
95:78,
94:24,
93:22,
91:16,
88:24,
87:32,
84:38,
76:34,
74:76,
73:20,
70:60,
69:24,
66:12,
64:20,
61:114,
59:26,
58:28,
53:44,
51:32,
50:14,
48:32,
47:12,
44:36,
42:28,
41:16,
30:32,
27:62,
25:16,
24:28,
19:68,
18:36,
13:24,
12:38,
11:20,
9:10,
8:44,
2:18,
1:12
}
var peflnation ={
0:'Афганистан',
1:'Албания',
2:'Алжир',
3:'Восточное Самоа',
4:'Андорра',
5:'Ангола',
6:'Ангуилла',
7:'Антигуа',
8:'Аргентина',
9:'Армения',
10:'Аруба',
11:'Австралия',
12:'Австрия',
13:'Азербайджан',
14:'Багамы',
15:'Бахрейн',
16:'Бангладеш',
17:'Барбадос',
18:'Беларусь',
19:'Бельгия',
20:'Белиз',
21:'Бенин',
22:'Бермуды',
23:'Бутан',
24:'Боливия',
25:'Босния',
26:'Ботсвана',
27:'Бразилия',
28:'Виргинские о-ва',
29:'Бруней',
30:'Болгария',
31:'Буркина Фасо',
32:'Бурунди',
34:'Комбоджа',
35:'Камерун',
36:'Канада',
37:'Кабо-Верде',
38:'Каймановы о-ва',
39:'ЦАР',
40:'Чад',
41:'Чили',
42:'Китай',
43:'Тайвань',
44:'Колумбия',
45:'Конго',
46:'О-ва Кука',
47:'Коста Рика',
48:'Хорватия',
49:'Куба',
50:'Кипр',
51:'Чехия',
53:'Дания',
54:'Джибути',
55:'Доминика',
56:'Доминиканская р-ка',
58:'Эквадор',
59:'Египет',
60:'Сальвадор',
61:'Англия',
62:'Экв. Гвинея',
63:'Эритрея',
64:'Эстония',
65:'Эфиопия',
66:'Македония',
67:'Фарерские о-ва',
68:'Фиджи',
69:'Финляндия',
70:'Франция',
71:'Габон',
72:'Гамбия',
73:'Грузия',
74:'Германия',
75:'Гана',
76:'Греция',
77:'Гренада',
78:'Гуам',
79:'Гватемала',
80:'Гвинея',
81:'Гвинея-Бисау',
82:'Гайана',
83:'Гаити',
84:'Голландия',
85:'Гондурас',
86:'Гон-Конг',
87:'Венгрия',
88:'Исландия',
89:'Индия',
90:'Индонезия',
91:'Иран',
92:'Ирак',
93:'Ирландия',
94:'Израиль',
95:'Италия',
96:'Кот`д`Ивуар',
97:'Ямайка',
98:'Япония',
99:'Иордания',
100:'Казахстан',
101:'Кения',
102:'Кувейт',
103:'Киргизия',
104:'Лаос',
105:'Латвия',
106:'Ливан',
107:'Лесото',
108:'Либерия',
109:'Ливия',
110:'Лихтенштейн',
111:'Литва',
112:'Люксембург',
113:'Макао',
114:'Мадагаскар',
115:'Малави',
116:'Малайзия',
117:'Мальдивы',
118:'Мали',
119:'Мальта',
120:'Мавритания',
121:'Маврикий',
122:'Мексика',
123:'Молдова',
124:'Монголия',
125:'Монсеррат',
126:'Марокко',
127:'Мозамбик',
128:'Мьянмар',
129:'Северная Ирландия',
130:'Намибия',
131:'Непал',
132:'Кюрасао',
133:'Новая Каледония',
134:'Новая Зеландия',
135:'Никарагуа',
136:'Нигер',
137:'Нигерия',
138:'Северная Корея',
139:'Норвегия',
140:'Оман',
141:'Пакистан',
142:'Палестина',
143:'Панама',
144:'Папуа Новая Гвинея',
145:'Парагвай',
147:'Перу',
148:'Филиппины',
149:'Польша',
150:'Португалия',
151:'Пуэрто-Рико',
152:'Катар',
153:'ДР Конго',
154:'Румыния',
155:'Россия',
156:'Руанда',
157:'Зап. Самоа',
158:'Сан-Марино',
159:'Томе',
160:'Саудовская Аравия',
161:'Шотландия',
162:'Сенегал',
163:'Сейшельские о-ва',
164:'Сьерра-Леоне',
165:'Сингапур',
166:'Словакия',
167:'Словения',
168:'Соломоновы о-ва',
169:'Сомали',
170:'ЮАР',
171:'Южная Корея',
172:'Испания',
173:'Шри-Ланка',
174:'Сент-Киттс',
175:'Лусия',
176:'Сент-Винсент',
177:'Судан',
178:'Суринам',
179:'Свазиленд',
180:'Швеция',
181:'Швейцария',
182:'Сирия',
184:'Таджикистан',
185:'Танзания',
186:'Таиланд',
188:'Того',
189:'Тонга',
190:'Тринидад и Тобаго',
191:'Тунис',
192:'Турция',
193:'Туркменистан',
194:'Каикос',
195:'ОАЭ',
196:'США',
199:'Уганда',
200:'Украина',
201:'Уругвай',
202:'Узбекистан',
203:'Вануату',
204:'Венесуэла',
205:'Вьетнам',
207:'Уэльс',
208:'Йемен',
209:'Сербия',
153:'Заир',
211:'Замбия',
212:'Зимбабве',
213:'Гваделупа',
214:'Черногория',
215:'Коморские острова',
216:'Таити',
}

var peflcountry=[1,2,8,9,11,12,13,18,19,24,25,27,30,41,42,44,47,48,50,51,53,58,59,61,64,66,69,70,73,74,76,84,87,88,91,93,94,95,98,100,105,111,122,123,126,129,137,139,145,147,149,150,152,154,155,160,161,166,167,170,171,172,180,181,191,192,195,196,200,201,202,204,96,207,209,214]
var pfc = []
$().ready(function(){
	$('td.back4').html('<b>Карта адаптации</b><br>')
	$.getScript("js/adaptation.en.js", function() {
		for (f=0;f<76;f++) {
			pfc[f] = []
			for(i in peflnation) pfc[f][i] = {'name':peflnation[i]}
		}
		for (i in s_adaptationMap) for(j in s_adaptationMap[i]) {
			pfc[j][i]['num'] = parseInt(s_adaptationMap[i][j])
			pfc[j][i]['id'] = i
		}
		PrintAd()
	});
});

function sNum(i, ii) { // По SumSkills (убыванию)
    if 		(i.num < ii.num)	return  1
    else if	(i.num > ii.num)	return -1
    else						return  0
}

function PrintAd(){
	var mtext = ''
	for( i in pfc){
		var pforn_sum = 0
		var text2 = '' 
		var pfcs = pfc[i].sort(sNum)
		for(j in pfcs){
			var pforn = pfcs[j]['num']*nationplayers[pfcs[j]['id']]/10
			pforn_sum += pforn
			text2 += '<tr align=right id="c'+i+'"'+(parseInt(localStorage.mycountry) == peflcountry[i] ? '' : ' style="display: none;"')+'>'
			text2 += '<td width=10%>'+pfcs[j]['num'] +'0%</td>'
			text2 += '<td align=left>'+ pfcs[j]['name']+'</td>'
			text2 += '<td>'+nationplayers[pfcs[j]['id']]+'</td>'
			text2 += '<td>'+pforn.toFixed(2).replace('.',',')+'</td>'
			text2 += '<td>'+(pforn/nationteamnum[peflcountry[i]]).toFixed(2).replace('.',',')+'</td>'
			text2 += '<td>'+'</td>'
			text2 += '</tr>'
		}
		var text1 = '<tr align=right id="cname" class=back3>'
		text1 += '<td align=left colspan=3 width=40%><a href="javascript:void(ShowC(\''+i+'\'))">'+s_adaptationResultList[i]+' ('+peflnation[peflcountry[i]]+')</a></td>'
		text1 += '<td>'+pforn_sum.toFixed(2).replace('.',',')+'</td>'
		text1 += '<td>'+(pforn_sum/nationteamnum[peflcountry[i]]).toFixed(2).replace('.',',')+'</td>'
		text1 += '<td align=left width=30%>'+nationteamnum[peflcountry[i]]+'</td>'
		text1 += '</tr>'
		if(parseInt(localStorage.mycountry) == peflcountry[i]) mtext = text1+text2+mtext
		else mtext += text1+text2
	}
	mtext = '<table width=100%><tr><td colspan=2>Страна</td><td width=10%>игроков</td><td>для&nbsp;страны</td><td>для&nbsp;команды</td><td>команд</td></tr>'+mtext+'</table>'
	$('td.back4').append('<table width=100%>'+mtext+'</table>')
}
function ShowC(n){
	if(String($('tr#c'+n+':first').attr('style')).indexOf('display: none') == -1) $('tr#c'+n).hide()
	else $('tr#c'+n).show()
}